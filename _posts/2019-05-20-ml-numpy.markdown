---
title: "Ô∏èüí° Machine Learning in Python NumPy: Neural Network in 9 Steps"
layout: post
date: 2019-05-20 23:00
published: true
headerImage: false
tag:
- DataScience
- MachineLearning
- DeepLearning
- Python
category: blog
author: edenau
description: "Understanding neural networks by coding"
# jemoji: '<img class="emoji" title=":open_file_folder:" alt=":open_file_folder:" src="https://assets.github.com/images/icons/emoji/unicode/1f5c2.png" height="20" width="20" align="absmiddle">'
---

***This post is now available on <a href="https://towardsdatascience.com/machine-learning-in-python-numpy-neural-network-in-9-steps-eafd0db25906" target="_blank">Towards Data Science ‚Äî Medium</a>. Check it out!***

***Source code is now available on <a href="https://github.com/edenau/ML-in-NumPy/blob/master/neural-net.ipynb" target="_blank">Github</a>. Check it out!***

# Motivation

If you are a **junior data scientist** who sort of understands how neural nets work, or a **machine learning enthusiast** who only knows a little about deep learning, this is the article that you cannot miss. Here is how you can build a neural net from scratch using NumPy in ***9 steps***‚Ää‚Äî‚Ääfrom data pre-processing to back-propagation‚Ää‚Äî‚Ääa must-do practice.

Basic understanding of machine learning, artificial neural network, Python syntax, and programming logic is preferred (but not necessary as you can learn on the go).

<div class="breaker"></div> <a id="1"></a>

# 1. Initialization

Step one. Import NumPy. Seriously.

{% gist b68b9803d38b691ab90680975b9bee24 %}

# 2. Data Generation

Deep learning is data-hungry. Although there are many clean datasets available online, we will generate our own for simplicity‚Ää‚Äî‚Ääfor inputs **a** and **b**, we have outputs **a+b**, **a-b**, and **\|a-b\|**. 10,000 datum points are generated.

{% gist d375786fd1452841e01820d2bdffae6c %}


# 3. Train-test Splitting

Our dataset is split into training (70%) and testing (30%) set. Only training set is leveraged for tuning neural networks. Testing set is used only for performance evaluation when the training is complete.

{% gist 95fa2ebc761b5a2ce3b5bc6389eec9d9 %}

# 4. Data Standardization

Data in the training set is standardized so that the distribution for each standardized feature is zero-mean and unit-variance. The scalers generated from the abovementioned procedure can then be applied to the testing set.

{% gist 81693265394ce40090d5bb037d9a009a %}

The scaler therefore does not contain any information from our testing set. We do not want our neural net to gain any information regarding testing set before network tuning.

We have now completed the data pre-processing procedures in ***4 steps***.

<div class="breaker"></div> <a id="2"></a>

# 5. Neural Net Construction

We objectify a ‚Äòlayer‚Äô using class in Python. Every layer (except the input layer) has a weight matrix **W**, a bias vector ***b***, and an activation function. Each layer is appended to a list called neural_net. That list would then be a representation of your fully connected neural network.

{% gist 8d338a1c4e631f5d80960fe695dd7ca4 %}

Finally, we do a sanity check on the number of hyperparameters using the following formula, and by counting. The number of datums available should exceed the number of hyperparameters, otherwise it will definitely overfit.

![1]({{ site.url }}/assets/posts/ml-numpy/nn-hp@2x.png)

<div class="breaker"></div> <a id="3"></a>

# Life with phones

Life with phones is all about replying to emails, messages, posts, comments, stories etc.. You always feel like you are lagging behind whilst the Earth keeps spinning (this part is true). You are going to miss a party invitation, or a job offer, or a piece of breaking news. Nothing pops up. Clack. You unlock your phone‚Ää‚Äî‚Äämaybe the data was off, let‚Äôs be sure.

I have come to accept the fact that I am always lagging behind. It is impossible to get up to speed. I might as well pause a little when necessary. Anxiety fades away. The world stops rotating for a while. No more music. No more noise. (Music is noise.)

>>Phonelessness is a pause button in life.

I did not activate my new phone until late evening when I finally had time to do so. I enjoyed my 24-hour phoneless experience. Whenever I feel like I have had enough, I turn off data (no one would call me anyway). I wish I could really go phoneless for a day, or a week.

I am going to a not-so-remote island next month for two weeks, and I aim to practice phonelessness willingly for the first time. Stay tuned.



<div class="breaker"></div> <a id="4"></a>

# About Me

Thanks for reading. I am an Edinburgh-based PhD student/data scientist. ***I write to find out what I think.***
